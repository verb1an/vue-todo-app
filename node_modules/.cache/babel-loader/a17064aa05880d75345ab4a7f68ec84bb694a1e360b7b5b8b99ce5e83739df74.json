{"ast":null,"code":"import \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { reactive, ref } from \"vue\";\nimport { getItemInDocById } from \"../getItem\";\nexport function useArrows() {\n  var arrows = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var list = reactive([]);\n  var area = ref(null);\n  var arrowMode = ref(false);\n  arrows.forEach(function (el) {\n    list.push(el);\n  });\n  var addNewArrow = function addNewArrow(items) {\n    // ? Check array on doubled arrows\n    var stop = list.find(function (el) {\n      if (el.firstItem == items.firstItem && el.secondItem == items.secondItem) {\n        return \"true\";\n      } else {\n        return false;\n      }\n    });\n    if (stop) return; // ? Stop if we find doubled\n\n    list.push({\n      id: Math.random() * 1000,\n      firstItem: items.firstItem,\n      secondItem: items.secondItem,\n      points: []\n    });\n  };\n  var setArrow = function setArrow(firstItem) {\n    var firstItemOffset = getItemInDocById(firstItem);\n    if (!firstItemOffset) return;\n    document.addEventListener(\"mousedown\", completeSetArrow(firstItemOffset), false);\n    arrowMode.value = true;\n    document.addEventListener(\"mousemove\", mouseMovelisterenerSetArrow(firstItemOffset), false);\n    mouseMovelisterenerSetArrow(firstItemOffset);\n  };\n  var removeArrow = function removeArrow(id) {\n    console.log(id);\n  };\n  var clearArea = function clearArea() {\n    area.value.innerHTML = \"\";\n  };\n  var drawArrow = function drawArrow(id, x1, y1, x2, y2) {\n    var _area$value$querySele;\n    var arrowItem = (_area$value$querySele = area.value.querySelector(\"g[arrow-id='\".concat(id, \"']\"))) !== null && _area$value$querySele !== void 0 ? _area$value$querySele : null;\n    if (arrowItem) {\n      arrowItem.querySelector(\".line__main\").setAttribute(\"x1\", x1);\n      arrowItem.querySelector(\".line__main\").setAttribute(\"y1\", y1);\n      arrowItem.querySelector(\".line__main\").setAttribute(\"x2\", x2);\n      arrowItem.querySelector(\".line__main\").setAttribute(\"y2\", y2);\n      return;\n    }\n    area.value.innerHTML += \"\\n            <g arrow-id='0' class=\\\"arrow__line\\\">\\n               <defs>\\n                   <marker id=\\\"arrowhead\\\" markerWidth=\\\"5\\\" markerHeight=\\\"4\\\" refX=\\\"5\\\" refY=\\\"2\\\" orient=\\\"auto\\\" fill=\\\"#fff\\\">\\n                       <polygon points=\\\"0 0, 5 2, 0 4\\\" />\\n                   </marker>\\n               </defs>\\n               <line class=\\\"line__main\\\" x1=\\\"\".concat(x1, \"\\\" y1=\\\"\").concat(y1, \"\\\" x2=\\\"\").concat(x2, \"\\\" y2=\\\"\").concat(y2, \"\\\" stroke-width=\\\"3\\\" stroke=\\\"#fff\\\" marker-end=\\\"url(#arrowhead)\\\" />\\n           </g>\\n        \");\n  };\n  var init = function init(areaID) {\n    area.value = document.getElementById(areaID);\n    clearArea();\n  };\n  var mouseMovelisterenerSetArrow = function mouseMovelisterenerSetArrow(firstItemOffset) {\n    var handler = function handler(event) {\n      if (arrowMode.value == false) {\n        document.removeEventListener(\"mousemove\", handler, false);\n        return;\n      }\n      var itemOffset = firstItemOffset.getBoundingClientRect();\n      var xPos = itemOffset.width / 2;\n      var yPos = itemOffset.height / 2;\n      var pageX = event.pageX;\n      var pageY = event.pageY;\n      if (itemOffset.top - pageY >= 100) {\n        yPos = 0;\n      } else if (pageY - itemOffset.bottom >= 100) {\n        yPos = itemOffset.height;\n      } else {\n        if (pageX >= itemOffset.right) {\n          xPos = itemOffset.width;\n          yPos = itemOffset.height / 2;\n        } else if (pageX <= itemOffset.left) {\n          xPos = 0;\n          yPos = itemOffset.height / 2;\n        } else {\n          xPos = itemOffset.width / 2;\n          yPos = 0;\n        }\n      }\n      drawArrow(0, itemOffset.left + xPos, itemOffset.top + yPos, pageX, pageY);\n    };\n    return handler;\n  };\n  var completeSetArrow = function completeSetArrow(firstItem) {\n    var handler = function handler(event) {\n      if (event.target.closest(\".todo__item\") && event.target.closest(\".todo__item\").getAttribute(\"todo-id\") == firstItem.getAttribute(\"todo-id\") || event.which == 2) {\n        return;\n      }\n      if (event.target.closest(\".todo__item\") !== null && event.which == 1) {\n        addNewArrow({\n          firstItem: firstItem.getAttribute(\"todo-id\"),\n          secondItem: event.target.closest(\".todo__item\").getAttribute(\"todo-id\")\n        });\n      }\n      document.removeEventListener(\"mousedown\", handler, false);\n      removeSetterArrows();\n    };\n    return handler;\n  };\n  var removeSetterArrows = function removeSetterArrows() {\n    arrowMode.value = false;\n    clearArea();\n  };\n  return {\n    list: list,\n    arrowMode: arrowMode,\n    addNewArrow: addNewArrow,\n    removeArrow: removeArrow,\n    setArrow: setArrow,\n    removeSetterArrows: removeSetterArrows,\n    init: init\n  };\n}","map":{"version":3,"names":["reactive","ref","getItemInDocById","useArrows","arrows","arguments","length","undefined","list","area","arrowMode","forEach","el","push","addNewArrow","items","stop","find","firstItem","secondItem","id","Math","random","points","setArrow","firstItemOffset","document","addEventListener","completeSetArrow","value","mouseMovelisterenerSetArrow","removeArrow","console","log","clearArea","innerHTML","drawArrow","x1","y1","x2","y2","_area$value$querySele","arrowItem","querySelector","concat","setAttribute","init","areaID","getElementById","handler","event","removeEventListener","itemOffset","getBoundingClientRect","xPos","width","yPos","height","pageX","pageY","top","bottom","right","left","target","closest","getAttribute","which","removeSetterArrows"],"sources":["C:/Users/Setis/Documents/alex/vue-todo-app/src/hooks/items/arrows.js"],"sourcesContent":["import { reactive, ref } from \"vue\";\r\nimport { getItemInDocById } from \"../getItem\";\r\n\r\nexport function useArrows(arrows = []) {\r\n    const list = reactive([]);\r\n    const area = ref(null);\r\n    const arrowMode = ref(false);\r\n\r\n    arrows.forEach((el) => {\r\n        list.push(el);\r\n    });\r\n\r\n    const addNewArrow = (items) => {\r\n        // ? Check array on doubled arrows\r\n        const stop = list.find((el) => {\r\n            if (el.firstItem == items.firstItem && el.secondItem == items.secondItem) {\r\n                return \"true\";\r\n            } else {\r\n                return false;\r\n            }\r\n        });\r\n\r\n        if (stop) return; // ? Stop if we find doubled\r\n\r\n        list.push({\r\n            id: Math.random() * 1000,\r\n            firstItem: items.firstItem,\r\n            secondItem: items.secondItem,\r\n            points: [],\r\n        });\r\n    };\r\n\r\n    const setArrow = (firstItem) => {\r\n        const firstItemOffset = getItemInDocById(firstItem);\r\n        if (!firstItemOffset) return;\r\n        document.addEventListener(\"mousedown\", completeSetArrow(firstItemOffset), false);\r\n        arrowMode.value = true;\r\n        document.addEventListener(\"mousemove\", mouseMovelisterenerSetArrow(firstItemOffset), false);\r\n\r\n        mouseMovelisterenerSetArrow(firstItemOffset);\r\n    };\r\n\r\n    const removeArrow = (id) => {\r\n        console.log(id);\r\n    };\r\n\r\n    const clearArea = () => {\r\n        area.value.innerHTML = \"\";\r\n    };\r\n\r\n    const drawArrow = (id, x1, y1, x2, y2) => {\r\n        const arrowItem = area.value.querySelector(`g[arrow-id='${id}']`) ?? null;\r\n\r\n        if (arrowItem) {\r\n            arrowItem.querySelector(\".line__main\").setAttribute(\"x1\", x1);\r\n            arrowItem.querySelector(\".line__main\").setAttribute(\"y1\", y1);\r\n            arrowItem.querySelector(\".line__main\").setAttribute(\"x2\", x2);\r\n            arrowItem.querySelector(\".line__main\").setAttribute(\"y2\", y2);\r\n\r\n            return;\r\n        }\r\n\r\n        area.value.innerHTML += `\r\n            <g arrow-id='0' class=\"arrow__line\">\r\n               <defs>\r\n                   <marker id=\"arrowhead\" markerWidth=\"5\" markerHeight=\"4\" refX=\"5\" refY=\"2\" orient=\"auto\" fill=\"#fff\">\r\n                       <polygon points=\"0 0, 5 2, 0 4\" />\r\n                   </marker>\r\n               </defs>\r\n               <line class=\"line__main\" x1=\"${x1}\" y1=\"${y1}\" x2=\"${x2}\" y2=\"${y2}\" stroke-width=\"3\" stroke=\"#fff\" marker-end=\"url(#arrowhead)\" />\r\n           </g>\r\n        `;\r\n    };\r\n\r\n    const init = (areaID) => {\r\n        area.value = document.getElementById(areaID);\r\n        clearArea();\r\n    };\r\n\r\n    const mouseMovelisterenerSetArrow = (firstItemOffset) => {\r\n        let handler = function (event) {\r\n            if (arrowMode.value == false) {\r\n                document.removeEventListener(\"mousemove\", handler, false);\r\n                return;\r\n            }\r\n            const itemOffset = firstItemOffset.getBoundingClientRect();\r\n            let xPos = itemOffset.width / 2;\r\n            let yPos = itemOffset.height / 2;\r\n            let pageX = event.pageX;\r\n            let pageY = event.pageY;\r\n\r\n            if (itemOffset.top - pageY >= 100) {\r\n                yPos = 0;\r\n            } else if (pageY - itemOffset.bottom >= 100) {\r\n                yPos = itemOffset.height;\r\n            } else {\r\n                if (pageX >= itemOffset.right) {\r\n                    xPos = itemOffset.width;\r\n                    yPos = itemOffset.height / 2;\r\n                } else if (pageX <= itemOffset.left) {\r\n                    xPos = 0;\r\n                    yPos = itemOffset.height / 2;\r\n                } else {\r\n                    xPos = itemOffset.width / 2;\r\n                    yPos = 0;\r\n                }\r\n            }\r\n\r\n            drawArrow(0, itemOffset.left + xPos, itemOffset.top + yPos, pageX, pageY);\r\n        };\r\n\r\n        return handler;\r\n    };\r\n\r\n    const completeSetArrow = (firstItem) => {\r\n        let handler = function (event) {\r\n            if (\r\n                (event.target.closest(\".todo__item\") &&\r\n                    event.target.closest(\".todo__item\").getAttribute(\"todo-id\") == firstItem.getAttribute(\"todo-id\")) ||\r\n                event.which == 2\r\n            ) {\r\n                return;\r\n            }\r\n\r\n            if (event.target.closest(\".todo__item\") !== null && event.which == 1) {\r\n                addNewArrow({\r\n                    firstItem: firstItem.getAttribute(\"todo-id\"),\r\n                    secondItem: event.target.closest(\".todo__item\").getAttribute(\"todo-id\"),\r\n                });\r\n            }\r\n\r\n            document.removeEventListener(\"mousedown\", handler, false);\r\n            removeSetterArrows();\r\n        };\r\n\r\n        return handler;\r\n    };\r\n\r\n    const removeSetterArrows = () => {\r\n        arrowMode.value = false;\r\n        clearArea();\r\n    };\r\n\r\n    return {\r\n        list,\r\n        arrowMode,\r\n\r\n        addNewArrow,\r\n        removeArrow,\r\n        setArrow,\r\n        removeSetterArrows,\r\n\r\n        init,\r\n    };\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}